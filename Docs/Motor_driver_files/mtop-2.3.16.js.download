!function(e,t){function n(){var e={},t=new m(function(t,n){e.resolve=t,e.reject=n});return e.promise=t,e}function o(e,t){for(var n in t)void 0===e[n]&&(e[n]=t[n]);return e}function r(e){var t=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]||document.firstElementChild||document;t.appendChild(e)}function i(e){var t=[];for(var n in e)e[n]&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}function a(e){return e.substring(e.lastIndexOf(".",e.lastIndexOf(".")-1)+1)}function s(e){function t(e,t){return e<<t|e>>>32-t}function n(e,t){var n,o,r,i,a;return r=2147483648&e,i=2147483648&t,n=1073741824&e,o=1073741824&t,a=(1073741823&e)+(1073741823&t),n&o?2147483648^a^r^i:n|o?1073741824&a?3221225472^a^r^i:1073741824^a^r^i:a^r^i}function o(e,t,n){return e&t|~e&n}function r(e,t,n){return e&n|t&~n}function i(e,t,n){return e^t^n}function a(e,t,n){return t^(e|~n)}function s(e,r,i,a,s,p,c){return e=n(e,n(n(o(r,i,a),s),c)),n(t(e,p),r)}function p(e,o,i,a,s,p,c){return e=n(e,n(n(r(o,i,a),s),c)),n(t(e,p),o)}function c(e,o,r,a,s,p,c){return e=n(e,n(n(i(o,r,a),s),c)),n(t(e,p),o)}function u(e,o,r,i,s,p,c){return e=n(e,n(n(a(o,r,i),s),c)),n(t(e,p),o)}function d(e){for(var t,n=e.length,o=n+8,r=(o-o%64)/64,i=16*(r+1),a=new Array(i-1),s=0,p=0;n>p;)t=(p-p%4)/4,s=p%4*8,a[t]=a[t]|e.charCodeAt(p)<<s,p++;return t=(p-p%4)/4,s=p%4*8,a[t]=a[t]|128<<s,a[i-2]=n<<3,a[i-1]=n>>>29,a}function l(e){var t,n,o="",r="";for(n=0;3>=n;n++)t=e>>>8*n&255,r="0"+t.toString(16),o+=r.substr(r.length-2,2);return o}function f(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);128>o?t+=String.fromCharCode(o):o>127&&2048>o?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t}var m,h,_,v,g,R,E,y,w,O=[],S=7,T=12,C=17,q=22,b=5,A=9,x=14,N=20,k=4,L=11,D=16,I=23,J=6,P=10,U=15,H=21;for(e=f(e),O=d(e),R=1732584193,E=4023233417,y=2562383102,w=271733878,m=0;m<O.length;m+=16)h=R,_=E,v=y,g=w,R=s(R,E,y,w,O[m+0],S,3614090360),w=s(w,R,E,y,O[m+1],T,3905402710),y=s(y,w,R,E,O[m+2],C,606105819),E=s(E,y,w,R,O[m+3],q,3250441966),R=s(R,E,y,w,O[m+4],S,4118548399),w=s(w,R,E,y,O[m+5],T,1200080426),y=s(y,w,R,E,O[m+6],C,2821735955),E=s(E,y,w,R,O[m+7],q,4249261313),R=s(R,E,y,w,O[m+8],S,1770035416),w=s(w,R,E,y,O[m+9],T,2336552879),y=s(y,w,R,E,O[m+10],C,4294925233),E=s(E,y,w,R,O[m+11],q,2304563134),R=s(R,E,y,w,O[m+12],S,1804603682),w=s(w,R,E,y,O[m+13],T,4254626195),y=s(y,w,R,E,O[m+14],C,2792965006),E=s(E,y,w,R,O[m+15],q,1236535329),R=p(R,E,y,w,O[m+1],b,4129170786),w=p(w,R,E,y,O[m+6],A,3225465664),y=p(y,w,R,E,O[m+11],x,643717713),E=p(E,y,w,R,O[m+0],N,3921069994),R=p(R,E,y,w,O[m+5],b,3593408605),w=p(w,R,E,y,O[m+10],A,38016083),y=p(y,w,R,E,O[m+15],x,3634488961),E=p(E,y,w,R,O[m+4],N,3889429448),R=p(R,E,y,w,O[m+9],b,568446438),w=p(w,R,E,y,O[m+14],A,3275163606),y=p(y,w,R,E,O[m+3],x,4107603335),E=p(E,y,w,R,O[m+8],N,1163531501),R=p(R,E,y,w,O[m+13],b,2850285829),w=p(w,R,E,y,O[m+2],A,4243563512),y=p(y,w,R,E,O[m+7],x,1735328473),E=p(E,y,w,R,O[m+12],N,2368359562),R=c(R,E,y,w,O[m+5],k,4294588738),w=c(w,R,E,y,O[m+8],L,2272392833),y=c(y,w,R,E,O[m+11],D,1839030562),E=c(E,y,w,R,O[m+14],I,4259657740),R=c(R,E,y,w,O[m+1],k,2763975236),w=c(w,R,E,y,O[m+4],L,1272893353),y=c(y,w,R,E,O[m+7],D,4139469664),E=c(E,y,w,R,O[m+10],I,3200236656),R=c(R,E,y,w,O[m+13],k,681279174),w=c(w,R,E,y,O[m+0],L,3936430074),y=c(y,w,R,E,O[m+3],D,3572445317),E=c(E,y,w,R,O[m+6],I,76029189),R=c(R,E,y,w,O[m+9],k,3654602809),w=c(w,R,E,y,O[m+12],L,3873151461),y=c(y,w,R,E,O[m+15],D,530742520),E=c(E,y,w,R,O[m+2],I,3299628645),R=u(R,E,y,w,O[m+0],J,4096336452),w=u(w,R,E,y,O[m+7],P,1126891415),y=u(y,w,R,E,O[m+14],U,2878612391),E=u(E,y,w,R,O[m+5],H,4237533241),R=u(R,E,y,w,O[m+12],J,1700485571),w=u(w,R,E,y,O[m+3],P,2399980690),y=u(y,w,R,E,O[m+10],U,4293915773),E=u(E,y,w,R,O[m+1],H,2240044497),R=u(R,E,y,w,O[m+8],J,1873313359),w=u(w,R,E,y,O[m+15],P,4264355552),y=u(y,w,R,E,O[m+6],U,2734768916),E=u(E,y,w,R,O[m+13],H,1309151649),R=u(R,E,y,w,O[m+4],J,4149444226),w=u(w,R,E,y,O[m+11],P,3174756917),y=u(y,w,R,E,O[m+2],U,718787259),E=u(E,y,w,R,O[m+9],H,3951481745),R=n(R,h),E=n(E,_),y=n(y,v),w=n(w,g);var j=l(R)+l(E)+l(y)+l(w);return j.toLowerCase()}function p(e,t,n){var o=n||{};document.cookie=e.replace(/[^+#$&^`|]/g,encodeURIComponent).replace("(","%28").replace(")","%29")+"="+t.replace(/[^+#$&\/:<-\[\]-}]/g,encodeURIComponent)+(o.domain?";domain="+o.domain:"")+(o.path?";path="+o.path:"")+(o.secure?";secure":"")+(o.httponly?";HttpOnly":"")}function c(e){var t=new RegExp("(?:^|;\\s*)"+e+"\\=([^;]+)(?:;\\s*|$)").exec(document.cookie);return t?t[1]:void 0}function u(e,t,n){var o=new Date;o.setTime(o.getTime()-864e5);var r="/";document.cookie=e+"=;path="+r+";domain=."+t+";expires="+o.toGMTString(),document.cookie=e+"=;path="+r+";domain=."+n+"."+t+";expires="+o.toGMTString()}function d(){var t=e.location.hostname;if(!t){var n=e.parent.location.hostname;n&&~n.indexOf("zebra.alibaba-inc.com")&&(t=n)}var o=["taobao.net","taobao.com","tmall.com","tmall.hk","etao.com","alibaba-inc.com"],r=new RegExp("([^.]*?)\\.?((?:"+o.join(")|(?:").replace(/\./g,"\\.")+"))","i"),i=t.match(r)||[],a=i[2]||"taobao.com",s=i[1]||"m";"taobao.net"!==a||"x"!==s&&"waptest"!==s&&"daily"!==s?"taobao.net"===a&&"demo"===s?s="demo":"alibaba-inc.com"===a&&"zebra"===s?s="zebra":"waptest"!==s&&"wapa"!==s&&"m"!==s&&(s="m"):s="waptest";var p="etao.com"===a?"apie":"api";p="taobao.com"===a?"acs":p,R.mainDomain=a,R.subDomain=s,R.prefix=p}function l(){var t=e.navigator.userAgent,n=t.match(/WindVane[\/\s]([\d\.\_]+)/);n&&(R.WindVaneVersion=n[1]);var o=t.match(/AliApp\(([^\/]+)\/([\d\.\_]+)\)/i);o&&(R.AliAppName=o[1],R.AliAppVersion=o[2])}function f(e){this.id=++w,this.params=o(e||{},{v:"*",data:{},type:"get",dataType:"jsonp"}),this.params.type=this.params.type.toLowerCase(),"object"==typeof this.params.data&&(this.params.data=JSON.stringify(this.params.data)),this.middlewares=E.slice(0)}var m=e.Promise;if(!m){var h="当前浏览器不支持Promise，请在windows对象上挂载Promise对象可参考（http://gitlab.alibaba-inc.com/mtb/lib-es6polyfill/tree/master）中的解决方案";throw t.mtop={ERROR:h},new Error(h)}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});var _,v=m.resolve();try{_=e.localStorage,_.setItem("@private","false")}catch(g){_=!1}var R={useAlipayJSBridge:!1},E=[],y={ERROR:-1,SUCCESS:0,TOKEN_EXPIRED:1,SESSION_EXPIRED:2};d(),l();var w=0,O="2.3.16";f.prototype.use=function(e){if(!e)throw new Error("middleware is undefined");return this.middlewares.push(e),this},f.prototype.__processRequestMethod=function(e){var t=this.params,n=this.options;"get"===t.type&&"jsonp"===t.dataType?n.getJSONP=!0:"get"===t.type&&"originaljsonp"===t.dataType?n.getOriginalJSONP=!0:"get"===t.type&&"json"===t.dataType?n.getJSON=!0:"post"===t.type&&(n.postJSON=!0),e()},f.prototype.__processRequestType=function(e){var n=this,o=this.options;if(R.H5Request===!0&&(o.H5Request=!0),R.WindVaneRequest===!0&&(o.WindVaneRequest=!0),o.H5Request===!1&&o.WindVaneRequest===!0){if(!t.windvane||parseFloat(o.WindVaneVersion)<5.4)throw new Error("WINDVANE_NOT_FOUND::缺少WindVane环境")}else o.H5Request===!0?o.WindVaneRequest=!1:"undefined"==typeof o.WindVaneRequest&&"undefined"==typeof o.H5Request&&(t.windvane&&parseFloat(o.WindVaneVersion)>=5.4?o.WindVaneRequest=!0:o.H5Request=!0);return e?e().then(function(){var e=o.retJson.ret;return e instanceof Array&&(e=e.join(",")),o.WindVaneRequest===!0&&(!e||e.indexOf("HY_FAILED")>-1||e.indexOf("HY_NO_HANDLER")>-1||e.indexOf("HY_CLOSED")>-1||e.indexOf("HY_EXCEPTION")>-1||e.indexOf("HY_NO_PERMISSION")>-1)?(R.H5Request=!0,n.__sequence([n.__processRequestType,n.__processToken,n.__processRequestUrl,n.__processUnitPrefix,n.middlewares,n.__processRequest])):void 0}):void 0};var S="_m_h5_c",T="_m_h5_tk",C="_m_h5_tk_enc";f.prototype.__getTokenFromAlipay=function(){var t=n(),o=this.options,r=(e.navigator.userAgent,!!location.protocol.match(/^https?\:$/)),i="AP"===o.AliAppName&&parseFloat(o.AliAppVersion)>=8.2;return o.useAlipayJSBridge===!0&&!r&&i&&e.AlipayJSBridge&&e.AlipayJSBridge.call?e.AlipayJSBridge.call("getMtopToken",function(e){e&&e.token&&(o.token=e.token),t.resolve()},function(){t.resolve()}):t.resolve(),t.promise},f.prototype.__getTokenFromCookie=function(){var e=this.options;return e.token=e.token||c(T),e.token&&(e.token=e.token.split("_")[0]),m.resolve()},f.prototype.__processToken=function(e){var t=this,n=this.options;this.params;return n.token&&delete n.token,n.WindVaneRequest!==!0?v.then(function(){return t.__getTokenFromAlipay()}).then(function(){return t.__getTokenFromCookie()}).then(e).then(function(){var e=n.retJson,o=e.ret;if(o instanceof Array&&(o=o.join(",")),o.indexOf("TOKEN_EMPTY")>-1||n.CDR===!0&&o.indexOf("ILLEGAL_ACCESS")>-1||o.indexOf("TOKEN_EXOIRED")>-1){if(n.maxRetryTimes=n.maxRetryTimes||5,n.failTimes=n.failTimes||0,n.H5Request&&++n.failTimes<n.maxRetryTimes)return t.__sequence([t.__processToken,t.__processRequestUrl,t.__processUnitPrefix,t.middlewares,t.__processRequest]);n.maxRetryTimes>0&&(u(S,n.pageDomain,"*"),u(T,n.mainDomain,n.subDomain),u(C,n.mainDomain,n.subDomain)),e.retType=y.TOKEN_EXPIRED}}):void e()},f.prototype.__processRequestUrl=function(t){var n=this.params,o=this.options;if(o.hostSetting&&o.hostSetting[e.location.hostname]){var r=o.hostSetting[e.location.hostname];r.prefix&&(o.prefix=r.prefix),r.subDomain&&(o.subDomain=r.subDomain),r.mainDomain&&(o.mainDomain=r.mainDomain)}if(o.H5Request===!0){var i="//"+(o.prefix?o.prefix+".":"")+(o.subDomain?o.subDomain+".":"")+o.mainDomain+"/h5/"+n.api.toLowerCase()+"/"+n.v.toLowerCase()+"/",a=n.appKey||("waptest"===o.subDomain?"4272":"12574478"),p=(new Date).getTime(),c=s(o.token+"&"+p+"&"+a+"&"+n.data),u={jsv:O,appKey:a,t:p,sign:c},d={data:n.data,ua:n.ua};Object.keys(n).forEach(function(e){"undefined"==typeof u[e]&&"undefined"==typeof d[e]&&(u[e]=n[e])}),o.getJSONP?u.type="jsonp":o.getOriginalJSONP?u.type="originaljsonp":(o.getJSON||o.postJSON)&&(u.type="originaljson"),o.querystring=u,o.postdata=d,o.path=i}t()},f.prototype.__processUnitPrefix=function(t){var n=this.params,o=this.options;if(o.disabledUnit===!0)return void t();if(_&&o.H5Request===!0){var i=n.api,a=!1,s=c("_m_user_unitinfo_"),p=_.getItem("unitinfo");s&&s.split("|")[0].indexOf("center")<0&&p&&p.indexOf(i.toLowerCase())>=0&&(a=s.split("|")[1]),o.h5UnitPrefix?o.path=o.path.replace(/^\/\//,"//"+o.h5UnitPrefix):a&&o.path&&(o.useAcsUnit===!0||o.path.indexOf("taobao.com")>-1&&"acs"===o.prefix?o.path=o.path.replace(/^\/\//,"//"+a):o.path=o.path.replace(/^\/\//,"//"+a+".")),t().then(function(){if(_){var t=c("_m_unitapi_v_"),n=_.getItem("unitinfo");if(t){var i=n?JSON.parse(n):{};if(!n||t!==i.version){var a=!1,s="//h5."+o.subDomain+".taobao.com/js/mtop/unit/"+t+"/unitApi.js",p=document.createElement("script");p.src=s,p.async=!0;var u=function(){a||(a=!0,p.onload=p.onerror=null,p.parentNode&&p.parentNode.removeChild(p))};p.onerror=function(){u()},e.jsonp_unitapi||(e.jsonp_unitapi=function(e){u(),_.setItem("unitinfo",JSON.stringify(e))}),r(p)}}}})}else t()};var q=0;f.prototype.__requestJSONP=function(e){function t(e){if(u&&clearTimeout(u),d.parentNode&&d.parentNode.removeChild(d),"TIMEOUT"===e)window[c]=function(){window[c]=void 0;try{delete window[c]}catch(e){}};else{window[c]=void 0;try{delete window[c]}catch(t){}}}var o=n(),a=this.params,s=this.options,p=a.timeout||2e4,c="mtopjsonp"+ ++q,u=setTimeout(function(){e("TIMEOUT::接口超时"),t("TIMEOUT")},p);s.querystring.callback=c;var d=document.createElement("script");return d.src=s.path+"?"+i(s.querystring)+"&"+i(s.postdata),d.async=!0,d.onerror=function(){t("ABORT"),e("ABORT::接口异常退出")},window[c]=function(){s.results=Array.prototype.slice.call(arguments),t(),o.resolve()},r(d),o.promise},f.prototype.__requestJSON=function(t){function o(e){l&&clearTimeout(l),"TIMEOUT"===e&&u.abort()}var r=n(),s=this.params,p=this.options,u=new e.XMLHttpRequest,d=s.timeout||2e4,l=setTimeout(function(){t("TIMEOUT::接口超时"),o("TIMEOUT")},d);p.pageDomain=p.pageDomain||a(e.location.hostname),p.mainDomain!=p.pageDomain&&(p.maxRetryTimes=3,p.CDR=!0,c(S)&&(p.querystring.c=decodeURIComponent(c(S)))),u.onreadystatechange=function(){if(4==u.readyState){var e,n,i=u.status;if(i>=200&&300>i||304==i){o(),e=u.responseText,n=u.getAllResponseHeaders()||"";try{e=/^\s*$/.test(e)?{}:JSON.parse(e),e.responseHeaders=n,p.results=[e],r.resolve()}catch(a){t("PARSE_JSON_ERROR::解析JSON失败")}}else o("ABORT"),t("ABORT::接口异常退出")}};var f,m,h=p.path+"?"+i(p.querystring);if(p.getJSON?(f="GET",h+="&"+i(p.postdata)):p.postJSON&&(f="POST",m=i(p.postdata)),u.open(f,h,!0),u.withCredentials=!0,u.setRequestHeader("Accept","application/json"),u.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.headers)for(var _ in s.headers)u.setRequestHeader(_,s.headers[_]);return u.send(m),r.promise},f.prototype.__requestWindVane=function(e){function o(e){c.results=[e],s.resolve()}var r,i,a,s=n(),p=this.params,c=this.options,u=p.data,d=p.api,l=p.v,f=c.postJSON?1:0,m=c.getJSON||c.postJSON?"originaljson":"",h="https"===location.protocol?1:0,_=p.isSec||0,v=p.sessionOption||"AutoLoginOnly";if("undefined"==typeof p.ecode)throw new Error("UNEXCEPT_PARAM_ECODE::缺少ecode参数");return r=parseInt(p.ecode),a="undefined"!=typeof p.timer?parseInt(p.timer):"undefined"!=typeof p.timeout?parseInt(p.timeout):2e4,i=2*a,p.needLogin===!0&&"undefined"==typeof p.sessionOption&&(v="AutoLoginAndManualLogin"),"undefined"!=typeof p.secType&&"undefined"==typeof p.isSec&&(_=p.secType),t.windvane.call("MtopWVPlugin","send",{api:d,v:l,post:String(f),type:m,isHttps:String(h),ecode:String(r),isSec:String(_),param:JSON.parse(u),timer:a,sessionOption:v,ext_headers:{referer:location.href}},o,o,i),s.promise},f.prototype.__processRequest=function(e,t){var n=this;return v.then(function(){var e=n.options;if(e.H5Request&&(e.getJSONP||e.getOriginalJSONP))return n.__requestJSONP(t);if(e.H5Request&&(e.getJSON||e.postJSON))return n.__requestJSON(t);if(e.WindVaneRequest)return n.__requestWindVane(t);throw new Error("UNEXCEPT_REQUEST::错误的请求类型")}).then(e).then(function(){var e=n.options,t=(n.params,e.results[0]),o=t&&t.ret||[];t.ret=o,o instanceof Array&&(o=o.join(","));var r=t.c;if(e.CDR&&r){var i=r.split(";");p(S,r,{domain:e.pageDomain,path:"/"}),p(T,i[0],{domain:e.pageDomain,path:"/"})}o.indexOf("SUCCESS")>-1?t.retType=y.SUCCESS:t.retType=y.ERROR,e.retJson=t})},f.prototype.__sequence=function(e){function t(e){if(e instanceof Array)e.forEach(t);else{var a,s=n(),p=n();r.push(function(){return s=n(),a=e.call(o,function(e){return s.resolve(e),p.promise},function(e){return s.reject(e),p.promise}),a&&(a=a["catch"](function(e){s.reject(e)})),s.promise}),i.push(function(e){return p.resolve(e),a})}}var o=this,r=[],i=[];e.forEach(t);for(var a,s=v;a=r.shift();)s=s.then(a);for(;a=i.pop();)s=s.then(a);return s};var b=function(e){e()},A=function(e){e()};f.prototype.request=function(e){var t=this;this.options=o(e||{},R);var n=m.resolve([b,A]).then(function(e){var n=e[0],o=e[1];return t.__sequence([n,t.__processRequestMethod,t.__processRequestType,t.__processToken,t.__processRequestUrl,t.__processUnitPrefix,t.middlewares,t.__processRequest,o])}).then(function(){var e=t.options.retJson;return e.retType!==y.SUCCESS?m.reject(e):t.options.successCallback?void t.options.successCallback(e):m.resolve(e)})["catch"](function(e){var n;return e instanceof Error?(console.error(e.stack),n={ret:[e.message],stack:[e.stack],retJson:y.ERROR}):n="string"==typeof e?{ret:[e],retJson:y.ERROR}:void 0!==e?e:t.options.retJson,t.options.failureCallback?void t.options.failureCallback(n):m.reject(n)});return this.__processRequestType(),t.options.H5Request&&(t.constructor.__firstProcessor||(t.constructor.__firstProcessor=n),b=function(e){t.constructor.__firstProcessor.then(e)["catch"](e)}),n},t.mtop=function(e){return new f(e)},t.mtop.request=function(e,t,n){var o={H5Request:e.H5Request,WindVaneRequest:e.WindVaneRequest,LoginRequest:e.LoginRequest,AntiCreep:e.AntiCreep,AntiFlood:e.AntiFlood,successCallback:t,failureCallback:n||t};return new f(e).request(o)},t.mtop.H5Request=function(e,t,n){var o={H5Request:!0,successCallback:t,failureCallback:n||t};return new f(e).request(o)},t.mtop.middlewares=E,t.mtop.config=R,t.mtop.RESPONSE_TYPE=y,t.mtop.CLASS=f}(window,window.lib||(window.lib={})),function(e,t){function n(e){return e.preventDefault(),!1}function o(t,o){var r=this,i=e.dpr||1,a=document.createElement("div"),s=document.documentElement.getBoundingClientRect(),p=Math.max(s.width,window.innerWidth)/i,c=Math.max(s.height,window.innerHeight)/i;a.style.cssText=["-webkit-transform:scale("+i+") translateZ(0)","-ms-transform:scale("+i+") translateZ(0)","transform:scale("+i+") translateZ(0)","-webkit-transform-origin:0 0","-ms-transform-origin:0 0","transform-origin:0 0","width:"+p+"px","height:"+c+"px","z-index:999999","position:absolute","left:0","top:0px","background:#FFF","display:none"].join(";");var u=document.createElement("div");u.style.cssText=["width:100%","height:52px","background:#EEE","line-height:52px","text-align:left","box-sizing:border-box","padding-left:20px","position:absolute","left:0","top:0","font-size:16px","font-weight:bold","color:#333"].join(";"),u.innerText=t;var d=document.createElement("a");d.style.cssText=["display:block","position:absolute","right:0","top:0","height:52px","line-height:52px","padding:0 20px","color:#999"].join(";"),d.innerText="关闭";var l=document.createElement("iframe");l.style.cssText=["width:100%","height:100%","border:0","overflow:hidden"].join(";"),u.appendChild(d),a.appendChild(u),a.appendChild(l),document.body.appendChild(a),l.src=o,d.addEventListener("click",function(){r.hide();var e=document.createEvent("HTMLEvents");e.initEvent("close",!1,!1),a.dispatchEvent(e)},!1),this.addEventListener=function(){a.addEventListener.apply(a,arguments)},this.removeEventListener=function(){a.removeEventListener.apply(a,arguments)},this.show=function(){document.addEventListener("touchmove",n,!1),a.style.display="block",window.scrollTo(0,0)},this.hide=function(){document.removeEventListener("touchmove",n),window.scrollTo(0,-s.top),a.parentNode&&a.parentNode.removeChild(a)}}function r(e){var n=this,o=this.options,r=this.params;return e().then(function(){var e=o.retJson,i=e.ret;if(i instanceof Array&&(i=i.join(",")),(i.indexOf("SESSION_EXPIRED")>-1||i.indexOf("SID_INVALID")>-1||i.indexOf("AUTH_REJECT")>-1||i.indexOf("NEED_LOGIN")>-1)&&(e.retType=u.SESSION_EXPIRED,!o.WindVaneRequest&&(c.LoginRequest===!0||o.LoginRequest===!0||r.needLogin===!0))){if(!t.login)throw new Error("LOGIN_NOT_FOUND::缺少lib.login");if(o.CDR!==!0)return t.login.goLoginAsync().then(function(e){return n.__sequence([n.__processToken,n.__processRequestUrl,n.__processUnitPrefix,n.middlewares,n.__processRequest])})["catch"](function(e){throw"CANCEL"===e?new Error("LOGIN_CANCEL::用户取消登录"):new Error("LOGIN_FAILURE::用户登录失败")});t.login.goLogin()}})}function i(e){var t=this.options;this.params;return t.H5Request!==!0||c.AntiFlood!==!0&&t.AntiFlood!==!0?void e():e().then(function(){var e=t.retJson,n=e.ret;n instanceof Array&&(n=n.join(",")),n.indexOf("FAIL_SYS_USER_VALIDATE")>-1&&e.data.url&&(t.AntiFloodReferer?location.href=e.data.url.replace(/(http_referer=).+/,"$1"+t.AntiFloodReferer):location.href=e.data.url)})}function a(t){var n=this,r=this.options,i=this.params;return i.forceAntiCreep!==!0&&r.H5Request!==!0||c.AntiCreep!==!0&&r.AntiCreep!==!0?void t():t().then(function(){var t=r.retJson,a=t.ret;return a instanceof Array&&(a=a.join(",")),a.indexOf("RGV587_ERROR::SM")>-1&&t.data.url?new s(function(r,a){function s(){u.removeEventListener("close",s),e.removeEventListener("message",p),a("USER_INPUT_CANCEL::用户取消输入")}function p(t){var o;try{o=JSON.parse(t.data)||{}}catch(c){}if(o&&"child"===o.type){u.removeEventListener("close",s),e.removeEventListener("message",p),u.hide();var d;try{d=JSON.parse(decodeURIComponent(o.content)),"string"==typeof d&&(d=JSON.parse(d));for(var l in d)i[l]=d[l];n.__sequence([n.__processToken,n.__processRequestUrl,n.__processUnitPrefix,n.middlewares,n.__processRequest]).then(r)}catch(c){a("USER_INPUT_FAILURE::用户输入失败")}}}var c=t.data.url,u=new o("",c);u.addEventListener("close",s,!1),e.addEventListener("message",p,!1),u.show()}):void 0})}if(!t||!t.mtop||t.mtop.ERROR)throw new Error("Mtop 初始化失败！请参考Mtop文档http://gitlab.alibaba-inc.com/mtb/lib-mtop");var s=e.Promise,p=t.mtop.CLASS,c=t.mtop.config,u=t.mtop.RESPONSE_TYPE;t.mtop.middlewares.push(r),t.mtop.loginRequest=function(e,t,n){var o={LoginRequest:!0,H5Request:!0,successCallback:t,failureCallback:n||t};return new p(e).request(o)},t.mtop.antiFloodRequest=function(e,t,n){var o={AntiFlood:!0,successCallback:t,failureCallback:n||t};return new p(e).request(o)},t.mtop.middlewares.push(i),t.mtop.antiCreepRequest=function(e,t,n){var o={AntiCreep:!0,successCallback:t,failureCallback:n||t};return new p(e).request(o)},t.mtop.middlewares.push(a)}(window,window.lib||(window.lib={}));